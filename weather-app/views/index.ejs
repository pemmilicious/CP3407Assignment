<script>
var mysql = require('mysql');
let currWeather = {};
var con = mysql.createConnection({
  host: "localhost",
  user: "root",
  password: "",
  database: "weather"
});

con.connect(function(err) {
  if (err) throw err;
  con.query("SELECT row FROM table WHERE id=(SELECT max(id) FROM table)", function (err, result, fields) {
    if (err) throw err;
    console.log(result);
    currWeather = result;
    console.log(currWeather);
  });
});
</script>


<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Weather</title>  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>
    <div class="container">
      <fieldset>
        <form action="/" method="post">
          <input name="city" type="text" class="ghost-input" placeholder="Enter a City" required>
          <input type="submit" class="ghost-button" value="Get Weather">
        </form>
        <% if(weather !== null){ %>
          <p><%= weather %></p>
        <% } %>

        <% if(error !== null){ %>
          <p><%= error %></p>
        <% } %>
      </fieldset>
    </div>
    <p><%= currWeather %></p>
      <div id="temp" style="width : 400px">
      <canvas id="tempChart" width="400px" height="400px"></canvas>
      <script>
        var ctx = document.getElementById("tempChart");
        var myChart = new Chart(ctx, {
            type: 'polarArea',
            data: {
                labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
                datasets: [{
                    label: '# of Votes',
                    data: [12, 19, 3, 5, 2, 3],
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(255, 206, 86, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255,99,132,1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(255, 206, 86, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero:true
                        }
                    }]
                }
            }
        });
        </script>
    </div>
          
      

  </body>
</html>